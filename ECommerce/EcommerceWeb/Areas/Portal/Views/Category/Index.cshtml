@using EcommerceApi.Enums
@using EcommerceWeb.Areas.Portal.Models.Categories
@model CategoryPageViewModel;
@{
    ViewData["Title"] = "Category Page";
    var isUpdate = Model.Category != null && Model.Category.categoryId != Guid.Empty;
    var showModal = isUpdate;
    var status = TempData["StatusMessage"] as string;
    if (status == "error")
    {
        showModal = true;
    }
    else
    {
        showModal = false;
    }

    if (Model.Category == null)
        Model.Category = new CategoryViewModel();
}
<script>
    tailwind.config = {
        theme: {
            extend: {
                colors: {
                    'ai-blue': '#10a37f',
                    'ai-dark': '#202123',
                    'ai-light': '#f7f7f8',
                    'ai-gray': '#343541',
                }
            }
        }
    }
</script>

<style>
    .gradient-bg {
        background: linear-gradient(135deg, #10a37f 0%, #1a73e8 100%);
    }

    .sidebar {
        transition: all 0.3s ease;
    }

    .sidebar-link:hover {
        background-color: rgba(255, 255, 255, 0.1);
    }

    .sidebar-link.active {
        background-color: rgba(255, 255, 255, 0.2);
    }

    .table-row:hover {
        background-color: #f0fdf4;
    }

    .category-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(16, 163, 127, 0.2);
    }

    .pulse-animation {
        animation: pulse 2s infinite;
    }


    .drag-handle {
        cursor: move;
    }
</style>

<div class="flex-1 flex flex-col overflow-hidden">
    <!-- Top Navigation -->
    <header class="bg-white shadow-sm">
        <div class="flex items-center justify-between px-6 py-3">
            <div class="flex items-center">

                <h2 class="text-xl font-semibold text-gray-800">Category Management</h2>
            </div>

            <div class="flex items-center space-x-4">
                <div class="relative">
                    <button class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-bell"></i>
                        <span class="absolute top-0 right-0 h-2 w-2 rounded-full bg-red-500"></span>
                    </button>
                </div>
                <div class="flex items-center">
                    <div class="w-8 h-8 rounded-full bg-gray-300 mr-2 overflow-hidden">
                        <img src="" alt="Admin" class="w-full h-full object-cover">
                    </div>
                    <span class="text-sm font-medium">Admin</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Content Area -->
    <main class="flex-1 overflow-y-auto p-6">
        <!-- Category Management -->
        <div class="space-y-6">
            <!-- Category Actions -->
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                <div>
                    <h2 class="text-2xl font-semibold">Product Categories</h2>
                    <p class="text-gray-600">Organize your products with categories and subcategories</p>
                </div>
                <div class="flex space-x-3">
                    <button class="bg-white border border-gray-300 px-4 py-2 rounded-lg hover:bg-gray-50 flex items-center">
                        <i class="fas fa-filter mr-2 text-gray-600"></i>
                        Filters
                    </button>
                    <button id="addCategoryBtn" class="gradient-bg text-white px-4 py-2 rounded-lg hover:opacity-90 transition flex items-center">
                        <i class="fas fa-plus mr-2"></i>
                        Add Category
                    </button>
                </div>
            </div>

            <!-- Category Stats -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                <div class="bg-white rounded-lg shadow p-4">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 text-sm">Total Categories</p>
                            <h3 class="text-xl font-bold">@Model.TotalCategories</h3>
                        </div>
                        <div class="w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600">
                            <i class="fas fa-tags"></i>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow p-4">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 text-sm">Active Categories</p>
                            <h3 class="text-xl font-bold">@Model.ActiveCategories</h3>
                        </div>
                        <div class="w-10 h-10 rounded-full bg-green-100 flex items-center justify-center text-green-600">
                            <i class="fas fa-check-circle"></i>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow p-4">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 text-sm">Featured Categories</p>
                            <h3 class="text-xl font-bold">@Model.FeaturedCategories</h3>
                        </div>
                        <div class="w-10 h-10 rounded-full bg-purple-100 flex items-center justify-center text-purple-600">
                            <i class="fas fa-star"></i>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow p-4">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 text-sm">Products in Categories</p>
                            <h3 class="text-xl font-bold">@Model.ProductsInCategories</h3>
                        </div>
                        <div class="w-10 h-10 rounded-full bg-orange-100 flex items-center justify-center text-orange-600">
                            <i class="fas fa-boxes"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Category View Options -->
            <div class="bg-white rounded-lg shadow p-4">
                <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
                    <div class="flex items-center space-x-2">
                        <button class="px-3 py-1 bg-ai-blue text-white rounded-lg">All</button>
                        <button class="px-3 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50">Top Level</button>
                        <button class="px-3 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50">Subcategories</button>
                        <button class="px-3 py-1 bg-white border border-gray-300 rounded-lg hover:bg-gray-50">Featured</button>
                    </div>
                    <div class="flex items-center space-x-3">
                        <div class="relative w-full md:w-64">
                            <input type="text" placeholder="Search categories..." class="w-full border border-gray-300 rounded-lg py-2 px-4 pl-10 focus:outline-none focus:ring-2 focus:ring-ai-blue focus:border-transparent">
                            <div class="absolute left-3 top-2.5 text-gray-400">
                                <i class="fas fa-search"></i>
                            </div>
                        </div>
                        <button class="p-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50">
                            <i class="fas fa-sort-alpha-down"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Category List View -->
            <div class="bg-white rounded-lg shadow overflow-hidden">
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    <div class="flex items-center">
                                        <span class="drag-handle mr-2"><i class="fas fa-grip-lines text-gray-400"></i></span>
                                        Category
                                    </div>
                                </th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Products
                                </th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Status
                                </th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Featured
                                </th>
                                <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Last Updated
                                </th>
                                <th scope="col" class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                    Actions
                                </th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">

                            @if (Model.Categories != null && Model.Categories.Any())
                            {
                                foreach (var category in Model.Categories)
                                {                                    
                                    <tr class="hover:bg-gray-50">
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <div class="flex items-center">
                                                <div class="flex-shrink-0 h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600">
                                                    <i class="fas fa-tag"></i>
                                                </div>
                                                <div class="ml-4">
                                                    <div class="text-sm font-medium text-gray-900">@(category?.name ?? "No Name")</div>
                                                    <div class="text-sm text-gray-500">
                                                        @(category?.parentId == null || category.parentId == Guid.Empty ? "Main Category" : "Subcategory")
                                                    </div>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <div class="text-sm text-gray-900">N/A</div> <!-- Replace with product count if available -->
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full @(category?.status == 0 ? "bg-green-100 text-green-800" : "bg-gray-100 text-gray-800")">
                                                @(category?.status.ToString() ?? "N/A")
                                            </span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full @(category?.isFeatured == true ? "bg-purple-100 text-purple-800" : "bg-gray-100 text-gray-800")">
                                                @(category?.isFeatured == true ? "Yes" : "No")
                                            </span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">                                            
                                            N/A
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                        <!-- ... other columns ... -->
                                        <td class="px-4 py-3 flex items-center justify-end">
                                            <a asp-area="Portal"
                                               asp-controller="Category"
                                               asp-action="Index"
                                               asp-route-id="@(category?.categoryId ?? Guid.Empty)"
                                               class="text-ai-blue hover:text-ai-dark mr-3">
                                                <i class="fas fa-edit"></i>
                                            </a>
                                            <form asp-area="Portal"
                                                  asp-controller="Category"
                                                  asp-action="Delete"
                                                  asp-route-id="@(category?.categoryId ?? Guid.Empty)"
                                                  method="post"
                                                  onsubmit="return confirm('Are you sure you want to delete this category?');">
                                                @Html.AntiForgeryToken()
                                                <button type="submit" class="text-red-500 hover:text-red-700">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </form>
                                        </td>
                                    </tr>                                            
                                }
                            }
                            else
                            {
                                <tr>
                                    <td colspan="6" class="text-center py-4 text-gray-500">No categories found.</td>
                                </tr>
                            }

                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Category Grid View (Alternative View) -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 hidden">
                <!-- Category Card 1 -->
                <div class="category-card bg-white rounded-xl shadow-sm overflow-hidden transition duration-300">
                    <div class="relative h-40 bg-gradient-to-r from-blue-100 to-blue-50 flex items-center justify-center">
                        <i class="fas fa-microchip text-4xl text-blue-600"></i>
                        <div class="absolute top-3 right-3 flex space-x-1">
                            <button class="bg-white p-2 rounded-full shadow-md hover:bg-gray-100">
                                <i class="fas fa-edit text-gray-600"></i>
                            </button>
                            <button class="bg-white p-2 rounded-full shadow-md hover:bg-gray-100">
                                <i class="fas fa-trash text-red-500"></i>
                            </button>
                        </div>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-lg text-ai-dark">Electronics</h3>
                        <p class="text-gray-500 text-sm">Main Category</p>
                        <div class="mt-4 flex items-center justify-between">
                            <span class="text-sm text-gray-700">428 products</span>
                            <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">Active</span>
                        </div>
                    </div>
                </div>

                <!-- Category Card 2 -->
                <div class="category-card bg-white rounded-xl shadow-sm overflow-hidden transition duration-300">
                    <div class="relative h-40 bg-gradient-to-r from-green-100 to-green-50 flex items-center justify-center">
                        <i class="fas fa-tshirt text-4xl text-green-600"></i>
                        <div class="absolute top-3 right-3 flex space-x-1">
                            <button class="bg-white p-2 rounded-full shadow-md hover:bg-gray-100">
                                <i class="fas fa-edit text-gray-600"></i>
                            </button>
                            <button class="bg-white p-2 rounded-full shadow-md hover:bg-gray-100">
                                <i class="fas fa-trash text-red-500"></i>
                            </button>
                        </div>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-lg text-ai-dark">Apparel</h3>
                        <p class="text-gray-500 text-sm">Main Category</p>
                        <div class="mt-4 flex items-center justify-between">
                            <span class="text-sm text-gray-700">312 products</span>
                            <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">Active</span>
                        </div>
                    </div>
                </div>

                <!-- Category Card 3 -->
                <div class="category-card bg-white rounded-xl shadow-sm overflow-hidden transition duration-300">
                    <div class="relative h-40 bg-gradient-to-r from-yellow-100 to-yellow-50 flex items-center justify-center">
                        <i class="fas fa-home text-4xl text-yellow-600"></i>
                        <div class="absolute top-3 right-3 flex space-x-1">
                            <button class="bg-white p-2 rounded-full shadow-md hover:bg-gray-100">
                                <i class="fas fa-edit text-gray-600"></i>
                            </button>
                            <button class="bg-white p-2 rounded-full shadow-md hover:bg-gray-100">
                                <i class="fas fa-trash text-red-500"></i>
                            </button>
                        </div>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-lg text-ai-dark">Home Goods</h3>
                        <p class="text-gray-500 text-sm">Main Category</p>
                        <div class="mt-4 flex items-center justify-between">
                            <span class="text-sm text-gray-700">198 products</span>
                            <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">Active</span>
                        </div>
                    </div>
                </div>

                <!-- Category Card 4 -->
                <div class="category-card bg-white rounded-xl shadow-sm overflow-hidden transition duration-300">
                    <div class="relative h-40 bg-gradient-to-r from-red-100 to-red-50 flex items-center justify-center">
                        <i class="fas fa-car text-4xl text-red-600"></i>
                        <div class="absolute top-3 right-3 flex space-x-1">
                            <button class="bg-white p-2 rounded-full shadow-md hover:bg-gray-100">
                                <i class="fas fa-edit text-gray-600"></i>
                            </button>
                            <button class="bg-white p-2 rounded-full shadow-md hover:bg-gray-100">
                                <i class="fas fa-trash text-red-500"></i>
                            </button>
                        </div>
                    </div>
                    <div class="p-4">
                        <h3 class="font-semibold text-lg text-ai-dark">Automotive</h3>
                        <p class="text-gray-500 text-sm">Main Category</p>
                        <div class="mt-4 flex items-center justify-between">
                            <span class="text-sm text-gray-700">87 products</span>
                            <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">Active</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Pagination -->
            <div class="mt-8 flex justify-center">
                <nav class="inline-flex rounded-md shadow-sm">
                    <a href="#" class="px-3 py-1 rounded-l-lg border border-gray-300 bg-white text-gray-500 hover:bg-gray-50">
                        <i class="fas fa-chevron-left"></i>
                    </a>
                    <a href="#" class="px-4 py-1 border-t border-b border-gray-300 bg-white text-ai-blue font-medium">1</a>
                    <a href="#" class="px-4 py-1 border-t border-b border-gray-300 bg-white text-gray-500 hover:bg-gray-50">2</a>
                    <a href="#" class="px-4 py-1 border-t border-b border-gray-300 bg-white text-gray-500 hover:bg-gray-50">3</a>
                    <a href="#" class="px-4 py-1 border-t border-b border-gray-300 bg-white text-gray-500 hover:bg-gray-50">4</a>
                    <a href="#" class="px-4 py-1 border-t border-b border-gray-300 bg-white text-gray-500 hover:bg-gray-50">5</a>
                    <span class="px-4 py-1 border-t border-b border-gray-300 bg-white text-gray-500">...</span>
                    <a href="#" class="px-4 py-1 border-t border-b border-gray-300 bg-white text-gray-500 hover:bg-gray-50">12</a>
                    <a href="#" class="px-3 py-1 rounded-r-lg border border-gray-300 bg-white text-gray-500 hover:bg-gray-50">
                        <i class="fas fa-chevron-right"></i>
                    </a>
                </nav>
            </div>
        </div>
        <!-- Add/Edit Category Modal -->
        <div id="categoryModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 @(showModal ? "" : "hidden")">
            <div class="bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto">
                <div class="flex items-center justify-between p-4 border-b">
                    <h3 class="text-lg font-semibold" id="categoryModalTitle">@(isUpdate ? "Update Category" : "Add New Category")</h3>
                    <button id="closeCategoryModal" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="p-6">
                    <form asp-area="Portal"
                          asp-controller="Category"
                          asp-action="Index"
                          asp-route-id="@(isUpdate ? Model.Category?.categoryId : null)"
                          method="post"
                          id="categoryForm"
                          enctype="multipart/form-data">


                        @Html.AntiForgeryToken()
                        <input type="hidden" asp-for="Category.categoryId" id="categoryId" name="Category.categoryId" />

                        <div class="grid grid-cols-1 gap-6">
                            <!-- Basic Information -->
                            <div>
                                <h4 class="text-lg font-medium mb-4 text-ai-dark border-b pb-2">Basic Information</h4>
                                <div class="mb-4">

                                    <label for="categoryName" class="block text-sm font-medium text-gray-700 mb-1">Category Name*</label>
                                    <input type="text" id="categoryName" name="Category.name" asp-for="Category.name" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-ai-blue focus:border-ai-blue">
                                    <span asp-validation-for="Category.name" class="text-red-500 text-sm"></span>

                                </div>
                                <div class="mb-4">
                                    <label for="categoryParent" class="block text-sm font-medium text-gray-700 mb-1">Parent Category</label>
                                    <select id="categoryParent" name="Category.parentId" asp-for="Category.parentId" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-ai-blue focus:border-ai-blue">
                                        <option value="">None (Top Level Category)</option>
                                        
                                        @foreach (var category in Model.Categories)
                                        {
                                            if (category.categoryId == Model.Category?.categoryId)
                                            {
                                                <option value="@category.categoryId" selected >@category.name</option>
                                            }
                                            else
                                            {
                                                <option value="@category.categoryId">@category.name</option>
                                            }
                                        }
                                    </select>
                                </div>
                                <div class="mb-4">
                                    <label for="categoryDescription" class="block text-sm font-medium text-gray-700 mb-1">Description</label>
                                    <textarea id="categoryDescription" name="Category.description" asp-for="Category.description" rows="3" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-ai-blue focus:border-ai-blue"></textarea>
                                    <span asp-validation-for="Category.description" class="text-red-500 text-sm"></span>
                                </div>
                            </div>

                            <!-- Display Settings -->
                            <div>
                                <h4 class="text-lg font-medium mb-4 text-ai-dark border-b pb-2">Display Settings</h4>
                                <div class="mb-4">
                                    <label asp-for="Category.IconClass" name="Category.IconClass" class="block text-sm font-medium text-gray-700 mb-1">Icon</label>
                                    <div class="flex items-center">
                                        <div class="mr-4">
                                            <div id="categoryIconPreview" class="w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center text-blue-600">
                                                <i class="@Model.Category?.IconClass"></i>
                                            </div>
                                        </div>
                                        
                                        <select id="categoryIcon" name="Category.IconClass" asp-for="Category.IconClass" class="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-ai-blue focus:border-ai-blue">
                                            <option value="fa fa-tag">Default (fa-tag)</option>
                                            <option value="fa fa-microchip">Electronics (fa-microchip)</option>
                                            <option value="fa fa-tshirt">Apparel (fa-tshirt)</option>
                                            <option value="fa fa-home">Home (fa-home)</option>
                                            <option value="fa fa-car">Automotive (fa-car)</option>
                                            <option value="fa fa-robot">AI (fa-robot)</option>
                                            <option value="fa fa-laptop">Computer (fa-laptop)</option>
                                            <option value="fa fa-mobile">Mobile (fa-mobile)</option>
                                        </select>
                                        <span asp-validation-for="Category.IconClass" class="text-red-500 text-sm"></span>
                                    </div>
                                </div>
                                <div class="mb-4">
                                    <label for="categoryColor" class="block text-sm font-medium text-gray-700 mb-1">Color Theme</label>
                                    <select id="categoryColor" name="Category.ColorTheme" asp-for="Category.ColorTheme" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-ai-blue focus:border-ai-blue">
                                        <option value="blue">Blue</option>
                                        <option value="green">Green</option>
                                        <option value="yellow">Yellow</option>
                                        <option value="red">Red</option>
                                        <option value="purple">Purple</option>
                                        <option value="pink">Pink</option>
                                        <option value="indigo">Indigo</option>
                                    </select>
                                    <span asp-validation-for="Category.ColorTheme" class="text-red-500 text-sm"></span>
                                </div>
                                <div class="mb-4">
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Featured Image</label>
                                    <div class="border-2 border-dashed border-gray-300 rounded-lg p-4 text-center">
                                        <div class="flex flex-col items-center justify-center py-4">
                                            <i class="fas fa-cloud-upload-alt text-2xl text-gray-400 mb-2"></i>
                                            <p class="text-sm text-gray-500 mb-1">Drag & drop image here or click to browse</p>
                                            <p class="text-xs text-gray-400">Recommended size: 800x800px</p>
                                        </div>
                                        <input type="file" asp-for="Category.ImageFile" id="categoryImageInput" class="hidden" accept="image/*" />
                                        <button type="button" id="uploadCategoryImageBtn" class="gradient-bg text-white px-4 py-2 rounded-md hover:opacity-90 text-sm">
                                            Upload Image
                                        </button>
                                        <span asp-validation-for="Category.ImageFile" class="text-red-500 text-sm"></span>
                                    </div>
                                    <div class="mt-2" id="categoryImagePreview">
                                       @if (Model.Category != null && Model.Category.FeaturedImageUri != null)
                                        {
                                            <img src="@Model.Category.FeaturedImageUri" class="w-32 h-32 object-cover rounded-md" />
                                        }  
                                    </div>
                                    <input type="hidden" asp-for="Category.FeaturedImageId" />
                                </div>
                            </div>
                            <!-- Status & SEO -->
                            <div>
                                <h4 class="text-lg font-medium mb-4 text-ai-dark border-b pb-2">Status & SEO</h4>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div class="mb-4">
                                        <label for="categoryStatus" class="block text-sm font-medium text-gray-700 mb-1">Status*</label>
                                        <select id="categoryStatus" name="Category.status" asp-for="Category.status" asp-items="Html.GetEnumSelectList<EcommerceApi.Enums.CategoryStatus>()" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-ai-blue focus:border-ai-blue">
                                        </select>
                                        <span asp-validation-for="Category.status" class="text-red-500 text-sm"></span>
                                    </div>
                                    <div class="mb-4">
                                        <label for="categoryFeatured" class="block text-sm font-medium text-gray-700 mb-1">Featured</label>
                                        <select id="categoryFeatured"
                                                name="Category.isFeatured"
                                                asp-for="Category.isFeatured"
                                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-ai-blue focus:border-ai-blue">
                                                <option value="false" selected="@(Model.Category.isFeatured == false ? "selected" : null)">No</option>
                                                <option value="true" selected="@(Model.Category.isFeatured == true ? "selected" : null)">Yes</option>
                                        </select>
                                        <span asp-validation-for="Category.isFeatured" class="text-red-500 text-sm"></span>
                                    </div>
                                </div>
                                <div class="mb-4">
                                    <label for="categoryMetaTitle" class="block text-sm font-medium text-gray-700 mb-1">Meta Title</label>
                                    <input type="text" id="categoryMetaTitle" name="Category.MetaTitle" asp-for="Category.MetaTitle" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-ai-blue focus:border-ai-blue">
                                    <span asp-validation-for="Category.MetaTitle" class="text-red-500 text-sm"></span>
                                </div>
                                <div class="mb-4">
                                    <label for="categoryMetaDescription" class="block text-sm font-medium text-gray-700 mb-1">Meta Description</label>
                                    <textarea id="categoryMetaDescription" name="Category.MetaDescription" asp-for="Category.MetaDescription" rows="2" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-ai-blue focus:border-ai-blue"></textarea>
                                    <span asp-validation-for="Category.MetaDescription" class="text-red-500 text-sm"></span>
                                </div>
                                <div class="mb-4">
                                    <label for="categorySlug" class="block text-sm font-medium text-gray-700 mb-1">URL Slug</label>
                                    <input type="text" id="categorySlug" name="Category.slug" asp-for="Category.slug" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-ai-blue focus:border-ai-blue">
                                    <span asp-validation-for="Category.slug" class="text-red-500 text-sm"></span>
                                </div>
                            </div>
                        </div>
                        <div class="flex justify-end space-x-3 mt-6">
                            <a asp-area="Portal" asp-controller="Category" asp-action="Index"
                               class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50">
                                Cancel
                            </a>
                            <button type="submit" class="gradient-bg text-white px-4 py-2 rounded-md hover:opacity-90">
                                @(isUpdate ? "Update Category" : "Save Category")
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </main>
</div>
@{
    var StatusMessage = TempData["StatusMessage"] as string;

    if (StatusMessage == "success")
    {
        <script>
               document.addEventListener("DOMContentLoaded", function () {
                Swal.fire({
                    icon: 'success',
                    title: 'Success!',
                    text: 'Your operation was completed successfully.',
                    confirmButtonText: 'OK'
                });
            });
        </script>
    }
}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // DOM Elements
        debugger;
        const addCategoryBtn = document.getElementById('addCategoryBtn');
        const categoryModal = document.getElementById('categoryModal');
        const closeCategoryModal = document.getElementById('closeCategoryModal');
        const uploadCategoryImageBtn = document.getElementById('uploadCategoryImageBtn');
        const categoryImageInput = document.getElementById('categoryImageInput');
        const categoryImagePreview = document.getElementById('categoryImagePreview');
        const categoryIcon = document.getElementById('categoryIcon');
        const categoryIconPreview = document.getElementById('categoryIconPreview')?.querySelector('i');
        const categoryColor = document.getElementById('categoryColor');
        const cancelCategoryBtn = document.getElementById('cancelCategoryBtn');

        // Open modal when "Add Category" is clicked
        if (addCategoryBtn) {
            addCategoryBtn.addEventListener('click', () => {
                categoryModal.classList.remove('hidden');
               // document.getElementById('categoryModalTitle').textContent = 'Add New Category';
                resetFormPreviews();
            });
        }

        // Close modal
        if (closeCategoryModal) {
            closeCategoryModal.addEventListener('click', () => {
                categoryModal.classList.add('hidden');
                
                
            });
        }

        if (cancelCategoryBtn) {
            cancelCategoryBtn.addEventListener('click', () => categoryModal.classList.add('hidden'));
        }

        // Image upload handling
        if (uploadCategoryImageBtn && categoryImageInput) {
            debugger;
            uploadCategoryImageBtn.addEventListener('click', () => {
                categoryImageInput.click();
            });

            categoryImageInput.addEventListener('change', function(e) {
                if (this.files && this.files[0]) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        categoryImagePreview.innerHTML = `
                            <img src="${event.target.result}"
                                 class="w-32 h-32 object-cover rounded-md" />`;
                    };
                    reader.readAsDataURL(this.files[0]);
                }
            });
        }

        // Icon change handling
        if (categoryIcon && categoryIconPreview) {
            categoryIcon.addEventListener('change', function() {
                categoryIconPreview.className = this.value;
            });
        }

        // Color change handling
        if (categoryColor) {
            categoryColor.addEventListener('change', function() {
                updateColorPreview(this.value);
            });
        }

        // Initialize previews for edit mode
        function initializeEditModePreviews() {
            // Set icon preview
            if (categoryIcon && categoryIconPreview) {
                categoryIconPreview.className = categoryIcon.value;
            }

            // Set color preview
            if (categoryColor) {
                updateColorPreview(categoryColor.value);
            }
        }

        // Update color preview
        function updateColorPreview(color) {
            if (!categoryIconPreview) return;

            const colorClasses = {
                blue: 'bg-blue-100 text-blue-600',
                green: 'bg-green-100 text-green-600',
                yellow: 'bg-yellow-100 text-yellow-600',
                red: 'bg-red-100 text-red-600',
                purple: 'bg-purple-100 text-purple-600',
                pink: 'bg-pink-100 text-pink-600',
                indigo: 'bg-indigo-100 text-indigo-600'
            };

            // Remove all color classes
            const previewContainer = categoryIconPreview.parentElement;
            Object.values(colorClasses).forEach(classes => {
                classes.split(' ').forEach(cls => {
                    previewContainer.classList.remove(cls);
                });
            });

            // Add selected color classes
            colorClasses[color]?.split(' ').forEach(cls => {
                previewContainer.classList.add(cls);
            });
        }

        // Reset form previews to defaults
        function resetFormPreviews() {
            // Reset icon to default
            if (categoryIcon && categoryIconPreview) {
                categoryIcon.value = 'fa fa-tag';
                categoryIconPreview.className = 'fa fa-tag';
            }

            // Reset color to default
            if (categoryColor) {
                categoryColor.value = 'blue';
                updateColorPreview('blue');
            }

            // Clear image preview
            if (categoryImagePreview) {
                categoryImagePreview.innerHTML = '';
            }

            // Clear file input
            if (categoryImageInput) {
                categoryImageInput.value = '';
            }
        }

        // Initialize for edit mode
        @if (isUpdate)
        {
                <text>
                // Show modal for edit mode
                categoryModal.classList.remove('hidden');
                initializeEditModePreviews();
                </text>
        }
    });
</script>
